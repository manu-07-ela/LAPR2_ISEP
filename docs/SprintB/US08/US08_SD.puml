@startuml
autonumber
'hide footbox
actor "Administrator" as ADM

participant ":CreateChemicalAnalysisLaboratoryUI" as UI
participant ":CreateChemicalAnalysisLaboratoryController" as CTRL
participant ": Company" as Comp
participant "store: TestTypeStore" as TTS
participant "store: ClinicalAnalysisLaboratoryStore" as CALS
participant "cal: ClinicalAnalysisLaboratory" as CAL

activate ADM
ADM -> UI : asks to create a new Chemical Analysis Laboratory
activate UI
UI --> ADM : requests data to create a new Clinical Analysis Laboratory \n (name, address, phoneNumber , TIN, laboratoryId)
deactivate UI

ADM -> UI : types requested data
activate UI

UI -> CTRL : lc=getTestType()
activate CTRL

CTRL -> TTS : lc=getTestType()
activate TTS
|||
deactivate TTS
deactivate CTRL

UI --> ADM : shows a TestType list and ask to choose the ones intended
deactivate UI

ADM -> UI : selects the TestTypes intended
activate UI

UI -> CTRL : createClinicalAnalysisLaboratory(name, address, phoneNumber , TIN, laboratoryId,selectedTestTypesList)
activate CTRL

CTRL -> Comp : store = getClinicalAnalysisLaboratoryStore()
activate Comp
|||
deactivate Comp

CTRL -> CALS: cal = createClinicalAnalysisLaboratory\n(name, address, phoneNumber , TIN, laboratoryId,selectedTestTypesList)
activate CALS
|||
CALS -> CAL**: create (name, address, phoneNumber , TIN ,\n laboratoryId,selectedTestTypesList)
deactivate CALS
CTRL -> CALS : validateClinicalAnalysisLaboratory(cal)
activate CALS
deactivate CALS
deactivate CTRL

UI --> ADM: shows all data and requests confirmation
deactivate CTRL
deactivate UI

ADM -> UI : confirms the data
activate UI
UI -> CTRL : saveClinicalAnalysisLaboratory()
activate CTRL

CTRL -> CALS : saveClinicalAnalysisLaboratory(cal)
activate CALS

CALS -> CALS: validateClinicalAnalysisLaboratory(cal)
activate CALS
deactivate CALS
CALS -> CALS: addClinicalAnalysisLaboratory(cal)
activate CALS
deactivate CALS
deactivate CALS

UI --> ADM : informs operation success
deactivate CTRL
deactivate UI

deactivate ADM

@enduml