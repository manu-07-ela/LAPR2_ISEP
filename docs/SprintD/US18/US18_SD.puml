@startuml
autonumber
'hide footbox
actor "Administrator" as ADMIN

participant ": SendCovid19ReportUI" as UI
participant ": SendCovid19ReportController" as CTRL
participant ": Company" as comp
participant ": TestStore" as store
participant "report: Covid19Report" as report


activate ADMIN
ADMIN -> UI : Initiates the process of sending a Covid-19 comp to NHS.
activate UI
UI --> ADMIN : Request the current day
deactivate UI

ADMIN -> UI : Introduce the current day
activate UI
UI -> CTRL : getAvailableTypesOfData()
activate CTRL
CTRL -> comp : getAvailableTypesOfData()
activate comp
comp --> CTRL : availableTypesOfData
deactivate comp
CTRL --> UI : availableTypesOfData
deactivate CTRL
UI --> ADMIN : Show the type of data (day or week)  and ask to select one
deactivate UI

ADMIN -> UI : Select the desired type of data
activate UI
UI --> ADMIN : Request the number of historical points
deactivate UI

ADMIN -> UI : Introduce the number of historical points
activate UI

UI --> ADMIN : Request the dates interval
deactivate UI

ADMIN -> UI : Defines the dates interval to fit the model
activate UI
UI -> CTRL : getAvailableRegressionModels()
activate CTRL
CTRL -> comp : getAvailableRegressionModels()
activate comp
comp --> CTRL : availableRegressionModels
deactivate comp
CTRL --> UI : availableRegressionModels
deactivate CTRL
UI --> ADMIN : Show available regression models and ask to select one
deactivate UI

ADMIN-> UI : Select the desired regression model
activate UI
alt regression model = Simple linear regression
UI -> CTRL : getAvailableIndependentVariables()
activate CTRL
CTRL -> comp : getAvailableIndependentVariables()
activate comp
comp --> CTRL : availableIndependentVariables()
deactivate comp
CTRL --> UI : availableIndependentVariables()
deactivate CTRL
UI --> ADMIN : Show the available independent variables and ask to select one
deactivate UI
ADMIN-> UI : Select the desired independent variable
activate UI
end

UI --> ADMIN : Request the significance level
deactivate UI

ADMIN -> UI : Introduce the significance level
activate UI

UI --> ADMIN : Request the confidence level
deactivate UI

ADMIN -> UI : Introduce the confidence level
activate UI

UI -> CTRL : createCovid19Report()
activate CTRL
CTRL -> comp : testStore = getTestStore()
activate comp
deactivate comp
CTRL -> store : lstCovidTestsValidateByInterval = getCovidTestsLstByInterval(initialDate, endDate)
activate store
deactivate store
CTRL -> store : lstCovidTestsValidateHistoricalPoints = getCovidTestsLstHistoricalPoints(currentDay, historicalPoints)
activate store
deactivate store
CTRL -> comp : createCovid19Report(lstCovidTests,lstCovidTestsHistoricalPoints)
activate comp
comp --> report** :create(lstCovidTests,lstCovidTestsHistoricalPoints)
report -> report : getPositiveCases()
activate report
deactivate report
deactivate comp
deactivate CTRL
UI --> ADMIN :  Presents all data and requests confirmation
deactivate UI

ADMIN -> UI : Confirms the data.
activate UI
UI -> CTRL : sendCovid19Report()
activate CTRL
CTRL -> comp : sendCovid19Report()
activate comp
comp --> CTRL : result
deactivate comp
CTRL --> UI : result
deactivate CTRL
UI --> ADMIN : Informs operation success.
deactivate UI

deactivate ADMIN

@enduml