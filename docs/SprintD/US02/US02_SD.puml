@startuml
'https://plantuml.com/sequence-diagram

autonumber
actor "Client" as CL

participant ": UpdateDataUI" as UI
participant ": UpdateDataController" as CTRL
participant ": Company" as COMP
participant "authFacade : AuthFacade" as AUTH
participant "userSession : UserSession" as SESSION
participant "store : ClientStore" as STORE
participant "client : Client" as CLIENT
participant ":ClientMapper" as MAPPER
participant "clientDto : ClientDTO" as DTO
activate CL
CL -> UI : asks to update personal data
activate UI
UI -> CTRL : getUserSession()
activate CTRL
CTRL -> COMP : authFacade = getAuthFacade()
activate COMP
COMP->AUTH : userSession = getCurrentUserSession()
activate AUTH
AUTH-> SESSION : email = getEmail()
activate SESSION
deactivate SESSION
deactivate AUTH
CTRL->COMP : store = getClientStore()
deactivate COMP
CTRL->STORE : client = getClientByEmail()
activate STORE
deactivate STORE
CTRL-> MAPPER : clientDto = toDto(client)
activate MAPPER
MAPPER-->CTRL : clientDto
deactivate MAPPER
CTRL-->UI : clientDto
deactivate CTRL

loop while the client wants to update his data
UI -> CL : show the personal data of the client
deactivate UI
CL -> UI : type the new data
activate UI
UI -->CL : show the new data an ask for confirmation
deactivate UI
CL->UI: confirm data
activate UI
alt attribute == name
UI-> CTRL : setName(name)
activate CTRL
CTRL --> UI : show the operation success
deactivate CTRL
UI-->CL : show the operation success
else attribute == citizenCardNumber
UI-> CTRL : setCitizenCardNumber(citizenCardNumber)
activate CTRL
CTRL --> UI : show the operation success
deactivate CTRL
UI-->CL : show the operation success
else attribute == nhsCode
UI->CTRL : setNhsCode(nhsCode)
activate CTRL
CTRL --> UI : show the operation success
deactivate CTRL
UI-->CL : show the operation success
else attribute == dateOfBirth
UI-> CTRL : setDateOfBirth(dateOfBirth)
activate CTRL
CTRL --> UI : show the operation success
deactivate CTRL
UI-->CL : show the operation success
else attribute == sex
UI-> CTRL : setSex(sex)
activate CTRL
CTRL --> UI : show the operation success
deactivate CTRL
UI-->CL : show the operation success
else attribute == tin
UI-> CTRL : setDateOfTin(tin)
activate CTRL
CTRL --> UI : show the operation success
deactivate CTRL
UI-->CL : show the operation success
else attribute == phoneNumber
UI-> CTRL : setPhoneNumber(phoneNumber)
activate CTRL
CTRL --> UI : show the operation success
deactivate CTRL
UI-->CL : show the operation success
else attribute == email
UI-> CTRL : setEmail(email)
activate CTRL
CTRL --> UI : show the operation success
deactivate CTRL
UI-->CL : show the operation success
end alt
deactivate UI
deactivate CL
end

@enduml