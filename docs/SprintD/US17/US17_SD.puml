@startuml
autonumber
'hide footbox
actor "Administrator" as ADMIN

participant ": ImportFileUI" as UI
participant ": ImportFileController" as CTRL
participant ": FileReader" as reader
participant "Company" as COMP
participant "clientStr: ClientStore" as clientStr
participant "client : Client" as Client
participant ":AuthFacade" as AF
participant "testStr: TestStore" as testStr
participant "test : Test" as Test

activate ADMIN
ADMIN -> UI : Initiates the process of Importing Clinical Tests
activate UI
UI --> ADMIN : Asks for the File's Path
deactivate UI

ADMIN -> UI : Introduces the File's Path
activate UI

UI --> ADMIN : Requests confirmation
deactivate UI

ADMIN -> UI : Confirms the data
activate UI
UI -> CTRL : loadFile(file)
activate CTRL
CTRL -> reader : readFile(file)
activate reader
reader -> reader : line = readLine()
activate reader
deactivate reader
reader -> reader : lineContent = split()
activate reader
deactivate reader
reader -> COMP : clientStr = getClientStore()
activate COMP
deactivate COMP
reader -> clientStr : getClientbytin(lineContent[5])
activate clientStr
clientStr --> reader : client
deactivate clientStr
alt client = null
reader --> Client :  create(lineContent[8], lineContent[3], lineContent[4], lineContent[6], lineContent[5], lineContent[7], lineContent[9],lineContent[10])
activate Client
deactivate Client
end
reader -> clientStr : saveClient(client)
activate clientStr
clientStr -> clientStr: validateClient(cl)
activate clientStr
deactivate clientStr

clientStr -> clientStr: addClient(cl)
activate clientStr
deactivate clientStr

clientStr -> clientStr: pwd = generatelogin(client);
activate clientStr
deactivate clientStr

clientStr -> AF: addUserWithRole(name,email,pwd,"CLIENT")
activate AF
deactivate AF
deactivate clientStr
deactivate clientStr
reader -> COMP : testStr = getTestStore()
activate COMP
deactivate COMP
reader -> testStr : test = createTest(client,nhsCode,testType,testParameterList,lab)
activate testStr
testStr -> testStr: internalcode = generateInternalCode(t)
activate testStr
deactivate testStr
testStr --> Test**: create(client,nhsCode,testType,testParameterList,lab,internalcode)
deactivate testStr
reader -> testStr : saveTest(test)
activate testStr

testStr -> testStr: validateTest(test)
activate testStr
deactivate testStr
testStr -> testStr: addTest(test)
activate testStr
deactivate testStr
deactivate testStr
deactivate reader
deactivate CTRL

UI --> ADMIN : Informs the operation sucess.
deactivate UI



deactivate ADMIN

@enduml